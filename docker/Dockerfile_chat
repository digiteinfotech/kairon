FROM python:3.7-buster

WORKDIR /app
USER root
RUN apt-get update -qq && \
python -m pip install --upgrade pip && \
python -m pip install tornado && \
python -m pip install rasa[full]==2.1.2 && \
python -m pip install mongoengine==0.23.1 && \
python -m pip install pyjwt && \
python -m pip install spacy==2.3.2 && \
python -m spacy download en_core_web_md && \
python -m spacy link en_core_web_md en && \
python -m pip install tensorflow==2.3.2 && \
python -m pip install numpy==1.19.5 && \
python -m pip install pymongo==3.12.0 && \
python -m pip install smart-config==0.1.3 && \
python -m pip install validators && \
python -m pip install dnspython && \
python -m pip install pydantic && \
python -m pip install password-strength && \
python -m pip install cryptography~=3.4.8 && \
python -m pip install loguru~=0.5.3 && \
python -m pip install elastic-apm && \
python -m pip install passlib[bcrypt] && \
python -m pip install pymongo==3.12.0
RUN python -m pip install fastapi

COPY kairon/ /app/kairon
COPY system.yaml /app/
COPY email.yaml /app/

USER 1001
EXPOSE 5000
CMD ["python","-m", "kairon.chat.server","--logging=debug"]

